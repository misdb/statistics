# 4-4. Hypergeometric Distribution

[R 초기하분포 \(Hypergeometric distribution\) : dhyper\(x, m, n, k\)](https://rfriend.tistory.com/100)

## 1. Hypergeometric Distribution

**Hypergeometric distribution**, in [statistics](https://www.britannica.com/science/statistics), [distribution function](https://www.britannica.com/science/distribution-function) in which selections are made from two groups without replacing members of the groups. The hypergeometric distribution differs from the [binomial distribution](https://www.britannica.com/science/binomial-distribution) in the lack of replacements. Thus, it often is employed in random [sampling](https://www.britannica.com/science/sampling-statistics) for [statistical quality control](https://www.britannica.com/science/statistics/Residual-analysis#ref60723). A simple everyday example would be the random selection of members for a team from a [population](https://www.britannica.com/science/population-biology-and-anthropology) of girls and boys.

In symbols, let the size of the population selected from be _N_, with _k_ elements of the population belonging to one group \(for convenience, called successes\) and _N_ − _k_ belonging to the other group \(called failures\). Further, let the number of samples drawn from the population be _n_, such that 0 ≤ _n_ ≤ _N_. Then the probability \(_P_\) that the number \(_X_\) of elements drawn from the successful group is equal to some number \(_x_\) is given by

![hypergeometric choose formula](https://cdn.britannica.com/71/130571-004-BF8684F1/formula.jpg)

using the notation of [binomial coefficients](https://www.britannica.com/science/combinatorics/Problems-of-enumeration#ref21879), or, using [factorial](https://www.britannica.com/science/factorial) notation,

![hypergeometric factorial formula](https://cdn.britannica.com/72/130572-004-6B016301/formula.jpg)

## 2. Mean and Variance

The [mean](https://www.britannica.com/science/mean) of the hypergeometric distribution is  $$\mu = \frac{nk}{N}$$ , 

and the [variance](https://www.britannica.com/topic/variance) \(square of the [standard deviation](https://www.britannica.com/topic/standard-deviation)\) is $$\sigma = \frac{nk(N − k)(N − n)}{N^2(N − 1)}$$ .

**EXAMPLE 1.** A batch of 100 piston rings is known to contain 10 defective rings. If two piston rings are drawn from the batch, write down the probabilities that: 

1. the first ring is defective; 
2. the second ring is defective given that the first one is defective.

**\[ Solution \]**

1. 10/ 100 = 1/10
2. 9/99 = 1/11

**EXMPLE 2.** A batch of 10 rocker cover gaskets contains 4 defective gaskets. If we draw samples of size 3 without replacement, from the batch of 10, find the probability that a sample contains 2 defective gaskets.

**\[ Solution \]**

* $$P(X=r) = \frac { _mC_r \space * \space  _{(n-m)}C_{(n-r)} } {_NC_m}$$ , $$N =10,  n =3, M=4 \space and \space r=2$$ 
* * $$P(X=2) = \frac {_4C_2 * _6C_1} {_{10}C_3} =  \frac {6*6}{120} = 0.3$$ 

**EXAMPLE 3.** For the previous Example, concerning rocker cover gaskets, find the expectation and variance of samples containing 2 defective gaskets.

**\[ Solution \]**

```text
E(X) = np = 3 * 4/10 = 1.2
V(X) = np(1-p) (N-M) / (N-1) = 3 * 4/10 * 6/10 * (10-4)/(10-1)
     = 0.48
```

**EXAMPLE 4.** In the manufacture of car tyres, a particular production process is know to yield 10 tyres with defective walls in every batch of 100 tyres produced. From a production batch of 100 tyres, a sample of 4 is selected for testing to destruction. Find: 

1. the probability that the sample contains 1 defective tyre 
2. the expectation of the number of defectives in samples of size 4 
3. the variance of the number of defectives in samples of size 4.

**\[ Solution \]**

* $$P(X=r) = \frac { _mC_r \space * \space  _{(n-m)}C_{(n-r)} } {_NC_m}$$ , ****$$N =100,  n =4,  M=10, \space and \space p=0.1$$ 

1. $$P(X=1) = \frac { _{10}C_1 * _{(100-10)}C_{(4-1)} } {_{100}C_4} = \frac {10 * 117480 }{3921225} ≈ 0.3$$ 
2. $$E(X) = np = 4 * 0.1 = 0.4$$ 
3. $$V(X) = np(1-p)\frac {N-M}{N-1} = 0.4 * 0.9 * \frac {90}{99} ≈0.33$$ 

## 3. Using R

초기하분포의 밀도 함수, 누적분포 함수, 분위수 함수, 난수 발생을 위한 R 함수 및 모수는 아래와 같습니다.

| **구분**  |  **** | **초기하분포 R 함수 / 모수** |
| :--- | :--- | :--- |
|  밀도 함수 | d |   dhyper\(x, m, n, k\) |
|  누적분포 함수 | p |   phyper\(q, m, n, k, lower.tail = TRUE/FALSE\) |
|  분위수 함수 | q |   qhyper\(p, m, n, k, lower.tail = TRUE/FALSE\) |
|  난수 발생 | r |   rhyper\(nn, m, n, k\) |

**참고 :** 모집단이 m과 n의 개체로 구성되어 있는데 k개의 표본을 추출.            lower.tail = TRUE 이면 확률변수 x를 기준으로 왼쪽 꼬리를 의미

###  3-1. Random Number Generation & Plotting

* Random Number Generation : `rhyper(nn, m, n, k)`
* Plotting : `dhyper(x, m, n, k)`

 m=5, n=20 인 초기하분포에서 비복원으로 4개를 추출하는 것을 1000번 모의실험한 후에 도수분포표를 구해보겠습니다.

{% tabs %}
{% tab title="R Code" %}
```text
# random number generation
random_hyper <- rhyper(100, m=5, n=20, k=4) ; random_hyper

# frequency table
y <- table(random_hyper)

# plotting
plot(y)
```
{% endtab %}

{% tab title="Random Number" %}
```text
> random_hyper <- rhyper(1000, m=5, n=20, k=4) ; random_hyper
   [1] 1 0 1 0 1 1 1 2 0 0 1 0 1 0 0 1 0 2 0 0 1 3 2 0 1 0 0 
   ... 중
```
{% endtab %}

{% tab title="Plot" %}
![](../.gitbook/assets/image%20%2832%29.png)
{% endtab %}
{% endtabs %}

### 3-2. Probability Computation

#### 1\) P\(X = 4\) 확률 계산 : dhyper\(x, m, n, k\)

**EXAMPLE 1.** 어떤 바리스타가 아메리카노 향 냄새를 맡아보기만 하면 "콜롬비아 원두"로 만든 것인지 아닌지를 맞출 수 있다고 주장하였다고 합니다.  그래서 그 바리스타를 데려다가 실험을 해보았습니다.  "콜롬비아 원두"로 만든 아메리카노 5잔 \(m=5\), 콜롬비아 원두 말고 다른 지역 원두로 만든 아메리카노 20잔 \(n=20\) 을 만들어 놓고 그 바리스타에게 "콜롬비아 원두"로 만든 아메리카노 5잔\(k\)을 골라내 보라고 시켰습니다.  이때 "콜롬비아 원두"로 만든 아메리카노를 4잔\(x\) 골라낼 확률은?

**\[ Solution \]**

* m : "콜롬비아 원두"로 만든 아메리카노 5잔 \(원하는 결과 대상\)
* n : 다른 지역 원두로 만든 아메리카노 20잔 \(원하지 않는 결과 대상\)
* k : 골라내는 커피 5잔 \(시행횟수\)
* x : 원하는 결과의 횟수 \(4잔\)

=&gt; $$P(X=4) = dhyper(x=4, m=5, n=20, k=5)$$ 

{% tabs %}
{% tab title="R Code" %}
```text
dhyper(x=4, m=5, n=20, k=5)
```
{% endtab %}

{% tab title="Result" %}
```text
> dhyper(x=4, m=5, n=20, k=5)
[1] 0.001882176
```
{% endtab %}
{% endtabs %}

**EXAMPLE 2.**  TV를 생산하는 제조회사에서 생산한 TV 100 대 중에서 품질이 양호한 TV가 95대, 불량품이 5대가 재고창고에 들어있다고 합니다.  이 재고 창고에서 TV 10개를 비복원추출한다고 했을 때 불량품이 3개가 포함되어 있을 확률은?

**\[Solution\]**

* m : 불량품의 대수 5대
* n : 양호한 TV 대수 95대
* k : 10대 비복원추출
* x : 불량품이 3대

=&gt; $$dhyper(3, m=5, n=95, k=10)$$ 

{% tabs %}
{% tab title="R Code" %}
```text
dhyper(3, m=5, n=95, k=10)
```
{% endtab %}

{% tab title="Result" %}
```text
> dhyper(3, m=5, n=95, k=10)
[1] 0.006383528
```
{% endtab %}
{% endtabs %}

#### 2\) $$P(X<=4)$$

* `phyper(x, m, n, k, lower.tail=TRUE)`  : lower.tail=TRUE 사용

**EXAMPLE 3.** EXAMPLE 1.에서 4잔 이하일 확률을 구하라.

**\[ Solution \]**

=&gt; $$phyper(4, m=5, n=20, k=5, lower.tail=TRUE)$$ 

{% tabs %}
{% tab title="R Code" %}
```text
phyper(4, m=5, n=20, k=5. lower.tail=TRUE)
```
{% endtab %}

{% tab title="Result" %}
```text
> phyper(4, m=5, n=20, k=5, lower.tail=TRUE)
[1] 0.9999812
```
{% endtab %}
{% endtabs %}

* 또는 $$P(X<=4) = P(X=1) + P(X=2) +P(X=3) + P(X=4)$$ 

{% tabs %}
{% tab title="R Code" %}
```text
sum(dhyper(x=c(0:4), m=5, n=20, k=5)
```
{% endtab %}

{% tab title="Second Tab" %}
```text
> sum(dhyper(x=c(0:4), m=5, n=20, k=5))
[1] 0.9999812
```
{% endtab %}
{% endtabs %}

#### 3-3.  특정 확률에 해당하는 분위수 구하기

`qhyper(p, m, n, k, lower.tail = TRUE/FALSE)`  


**EXAMPLE 4.**  EXAMPLE 1. 에서 확률이 0.03576134가 되는 시행횟수를 구하라.

**\[ Solution \]**

{% tabs %}
{% tab title="R Source" %}
```text
qhyper(p=0.03576134, m=5, n=20, k=5, lower.tail=FALSE)
```
{% endtab %}

{% tab title="x\*" %}
```text
> qhyper(p=0.03576134, m=5, n=20, k=5, lower.tail=FALSE)
[1] 3
```
{% endtab %}
{% endtabs %}

EXAMPLE 5.  누적확률이 0.998099가 되는 시행횟수를 구하라.

{% tabs %}
{% tab title="R Source" %}
```text
qhyper(p=0.03576134, m=5, n=20, k=5, lower.tail=TRUE)
```
{% endtab %}

{% tab title="x\*" %}
```text
> qhyper(p=0.998099, m=5, n=20, k=5, lower.tail=TRUE)
[1] 3
```
{% endtab %}
{% endtabs %}



